---
layout: post
title: Creating link to TFS Reports in build script
date: '2008-08-07T14:12:00.004+02:00'
author: Marcus Hammarberg
tags:
- Tools
- TFS
- MSBuild
modified_time: '2010-12-14T16:22:38.258+01:00'
blogger_id: tag:blogger.com,1999:blog-36533086.post-8109744470981793374
blogger_orig_url: http://www.marcusoft.net/2008/08/creating-link-to-tfs-reports-in-build.html
---

For a few days (on and off, not <span class="blsp-spelling-error" id="SPELLING_ERROR_0">continously</span>) I've been searching the net for some way to present code coverage data in a nice way. That is - when our build script is running tests under code coverage we don't present the code coverage result.<br /><br />The code coverage data is located in the <span class="blsp-spelling-error" id="SPELLING_ERROR_1">TRX</span>-file generated by <span class="blsp-spelling-error" id="SPELLING_ERROR_2">MSTest</span>. And there is a great tool, <a href="http://www.codeplex.com/trx2html"><span class="blsp-spelling-error" id="SPELLING_ERROR_3">trx</span>2html</a>, that I've already <a href="http://www.marcusoft.net/2008/03/publish-tfs-testresult-as-html.html">blogged </a>about. But that tool doesn't show the any code coverage result.<br /><br />Here I must add that I know these two things:<br /><ul><li>firstly the main part of the code coverage data is only interesting to the developers and might not benefit from being shown to others.<br />But I just want to show that 97% of our code is covered by out unit test. Calms the project management...</li><li>secondly - it might be a simple thing to tweak the internal XML Transformation of the <a href="http://www.codeplex.com/trx2html"><span class="blsp-spelling-error" id="SPELLING_ERROR_4">trx</span>2html</a>-tool.<br />But it doesn't feel good to have tweaked third party code in a professional environment.</li></ul><p>OK - after a long while I realized that <a href="http://en.wikipedia.org/wiki/Team_Foundation_Server"><span class="blsp-spelling-error" id="SPELLING_ERROR_5">TFS</span> </a>is, out of the box, giving us some reports. One of the is called Builds and simply shows a list of all builds, with code coverage data in place. </p><p>So I ran that report, which opens in the browser, and it did the trick; it shows the right amount of data at a reasonable level. </p><p>Now I just needed to create a link to the report and put it in the drop-folder for our build so that all persons interested could see the latest results. Here is what I did - not pretty, but it works;</p><ul><li>I browsed to the report and dragged the link (the little icon in the <span class="blsp-spelling-error" id="SPELLING_ERROR_6">url</span>-field) to my desktop</li><li>I opened that "Internet shortcut" in Notepad and copied the <span class="blsp-spelling-error" id="SPELLING_ERROR_7">entier</span> content</li><li>Then I added a <span class="blsp-spelling-error" id="SPELLING_ERROR_8">txt</span>-file to my solution and pasted the content of the Internet shortcut into that file.<br />For some reason you can't add a Internet shortcut to the solution.</li><li>Then I created a <span class="blsp-spelling-error" id="SPELLING_ERROR_9">MSBuild</span> target that copies the file to the drop location and change its file-extension to .<span class="blsp-spelling-error" id="SPELLING_ERROR_10">url</span>.<br />Here is my target:</li></ul><pre><br />    &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_11">lt</span>;!-- Target that creates a link to the builds report --&gt;<br />  &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_12">lt</span>;Target Name="<span class="blsp-spelling-error" id="SPELLING_ERROR_13">SkapaLankTillByggRapporten</span>"&gt;<br />    &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_14">lt</span>;<span class="blsp-spelling-error" id="SPELLING_ERROR_15">BuildStep</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_16">TeamFoundationServerUrl</span>="$(<span class="blsp-spelling-error" id="SPELLING_ERROR_17">TeamFoundationServerUrl</span>)"<br />               <span class="blsp-spelling-error" id="SPELLING_ERROR_18">BuildUri</span>="$(<span class="blsp-spelling-error" id="SPELLING_ERROR_19">BuildUri</span>)"<br />               Name="<span class="blsp-spelling-error" id="SPELLING_ERROR_20">CreateLinkFileToBuildReport</span>"<br />               Message="Create link to build report"<br />               Status="Succeeded" /&gt;<br />    &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_21">lt</span>;Message Text="Create link to build report" /&gt;<br />  <br />    &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_22">lt</span>;Copy <span class="blsp-spelling-error" id="SPELLING_ERROR_23">SourceFiles</span>="$(<span class="blsp-spelling-error" id="SPELLING_ERROR_24">SolutionRoot</span>)\Solution Items\Tools\<span class="blsp-spelling-error" id="SPELLING_ERROR_25">BuildReportLink</span>.<span class="blsp-spelling-error" id="SPELLING_ERROR_26">txt</span>" <span class="blsp-spelling-error" id="SPELLING_ERROR_27">DestinationFiles</span>="\\$(<span class="blsp-spelling-error" id="SPELLING_ERROR_28">DropServerName</span>)\Drops\$(<span class="blsp-spelling-error" id="SPELLING_ERROR_29">AppName</span>)\<span class="blsp-spelling-error" id="SPELLING_ERROR_30">TestResults</span>\<span class="blsp-spelling-error" id="SPELLING_ERROR_31">BuildReportLink</span>.<span class="blsp-spelling-error" id="SPELLING_ERROR_32">url</span>" /&gt;<br />  &amp;<span class="blsp-spelling-error" id="SPELLING_ERROR_33">lt</span>;/Target&gt;<br /></pre><br /><ul><li>Finally I made my build script call that target</li></ul><p>As I said - maybe not a very pretty solution but it sure came through for us and helped us report code coverage data in a nice way. </p><p><span class="blsp-spelling-corrected" id="SPELLING_ERROR_34">Oops</span> - almost forgot... To reconnect to the title of this post. This "technique" can of course be applied to any report in <span class="blsp-spelling-error" id="SPELLING_ERROR_35">TFS</span> or other URL-<span class="blsp-spelling-corrected" id="SPELLING_ERROR_36">addressable</span> <span class="blsp-spelling-corrected" id="SPELLING_ERROR_37">resources</span>.<br /></p>