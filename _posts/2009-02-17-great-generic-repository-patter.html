---
layout: post
title: Simple but useful generic repository pattern
date: '2009-02-16T22:44:00.001+01:00'
author: Marcus Hammarberg
tags:
- Tools
- C#
modified_time: '2010-12-14T16:22:38.205+01:00'
blogger_id: tag:blogger.com,1999:blog-36533086.post-7342434330790395493
blogger_orig_url: http://www.marcusoft.net/2009/02/great-generic-repository-patter.html
---

<p>I have <a href="http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx">pointed here</a> several times before – but it’s so nice. </p>  <p>It’s an <a href="http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/10/08/the-repository-pattern.aspx">implementation</a> of the <a href="http://martinfowler.com/eaaCatalog/repository.html">Repository Pattern</a> using generics, that will minimize your code in a very nice way. I am sure that the FindAll can be refined into something very nice with <a href="http://msdn.microsoft.com/en-us/library/bb308959.aspx">LINQ</a>, that allows you to send a specification criteria or so. </p>  <p>Here is my implementation that uses a common interface (IBaseEntity) for all my entities. It basically has an ID, so that the abstract implementation can use it as a key:</p>  <blockquote>   <p>namespace Marcusoft.SprintPlannerHelper.Repositories      <br />{       <br />&#160;&#160;&#160; /// &lt;summary&gt;       <br />&#160;&#160;&#160; /// A generic repository interface that dictates all the methods that a repository should map to       <br />&#160;&#160;&#160; /// &lt;/summary&gt;       <br />&#160;&#160;&#160; /// &lt;typeparam name=&quot;T&quot;&gt;the type of the interface&lt;/typeparam&gt;       <br />&#160;&#160;&#160; public interface IRepository&lt;T&gt;&#160; where T :IBaseEntity       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; T GetById(Guid id);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; IList&lt;T&gt; FindAll();       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; void Add(T entity);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; void Remove(T entity);       <br />&#160;&#160;&#160; }       <br />}</p>    <p>&#160;</p> </blockquote>  <blockquote>   <p>public abstract class Repository&lt;T&gt; : IRepository&lt;T&gt; where T : IBaseEntity      <br />{       <br />&#160;&#160;&#160; protected readonly Dictionary&lt;Guid, T&gt; dictionary = new Dictionary&lt;Guid, T&gt;(); </p>    <p>&#160;&#160;&#160; #region IRepository&lt;T&gt; Members&#160; <br />&#160;&#160; <br />&#160;&#160;&#160; public T GetById(Guid id)       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return dictionary[id];       <br />&#160;&#160;&#160; } </p>    <p>&#160;&#160;&#160; public IList&lt;T&gt; FindAll()      <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; return new List&lt;T&gt;(dictionary.Values);       <br />&#160;&#160;&#160; } </p>    <p>&#160;&#160;&#160; public void Add(T entity)      <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; dictionary.Add(entity.ID, entity);       <br />&#160;&#160;&#160; } </p>    <p>&#160;&#160;&#160; public void Remove(T entity)      <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; dictionary.Remove(entity.ID);       <br />&#160;&#160;&#160; } </p>    <p>&#160;&#160;&#160; #endregion      <br />} </p>    <p>&#160;</p> </blockquote>  <blockquote>   <p>public class ProductRepositoryFake: Repository&lt;Product&gt;, IProductRepository      <br />{       <br />&#160;&#160;&#160; /// &lt;summary&gt;       <br />&#160;&#160;&#160; /// Default constructor that fills the repository with some testdata       <br />&#160;&#160;&#160; /// &lt;/summary&gt;       <br />&#160;&#160;&#160; public ProductRepositoryFake()       <br />&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Add the products from the testdata-class       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; foreach (var p in TestData.GetTestProductList())       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; {       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; dictionary.Add(p.ID, p);       <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; }       <br />&#160;&#160;&#160; }       <br />}</p> </blockquote>  <p>I implemented it and wrote this with Albert sleeping on my chest. Just imagine if all programming sessions were so peaceful. </p>  