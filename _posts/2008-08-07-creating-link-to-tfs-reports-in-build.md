---
layout: post
title: Creating link to TFS Reports in build script
date: '2008-08-07T14:12:00.004+02:00'
author: Marcus Hammarberg
tags:
  - Tools - TFS - MSBuild
modified_time: '2010-12-14T16:22:38.258+01:00'
blogger_id: tag:blogger.com,1999:blog-36533086.post-8109744470981793374
blogger_orig_url: http://www.marcusoft.net/2008/08/creating-link-to-tfs-reports-in-build.html
---

For a few days (on and off, not continously) I've been searching the
net for some way to present code coverage data in a nice way. That is -
when our build script is running tests under code coverage we don't
present the code coverage result.

The code coverage data is located in the TRX-file generated by <span
id="SPELLING_ERROR_2" class="blsp-spelling-error">MSTest. And
there is a great tool, [trx2html](http://www.codeplex.com/trx2html),
that I've already
[blogged](http://www.marcusoft.net/2008/03/publish-tfs-testresult-as-html.html)
about. But that tool doesn't show the any code coverage result.

Here I must add that I know these two things:

-   firstly the main part of the code coverage data is only interesting
    to the developers and might not benefit from being shown to
    others.
    But I just want to show that 97% of our code is covered by out unit
    test. Calms the project management...
-   secondly - it might be a simple thing to tweak the internal XML
    Transformation of the [trx2html](http://www.codeplex.com/trx2html)-tool.
    But it doesn't feel good to have tweaked third party code in a
    professional environment.

OK - after a long while I realized that [TFS](http://en.wikipedia.org/wiki/Team_Foundation_Server)
is, out of the box, giving us some reports. One of the is called Builds
and simply shows a list of all builds, with code coverage data in place.

So I ran that report, which opens in the browser, and it did the trick;
it shows the right amount of data at a reasonable level.

Now I just needed to create a link to the report and put it in the
drop-folder for our build so that all persons interested could see the
latest results. Here is what I did - not pretty, but it works;

-   I browsed to the report and dragged the link (the little icon in the
    url-field) to my desktop
-   I opened that "Internet shortcut" in Notepad and copied the <span
    id="SPELLING_ERROR_7" class="blsp-spelling-error">entier
    content
-   Then I added a txt-file to my solution and
    pasted the content of the Internet shortcut into that file.
    For some reason you can't add a Internet shortcut to the solution.
-   Then I created a MSBuild target that copies the
    file to the drop location and change its file-extension to .<span
    id="SPELLING_ERROR_10" class="blsp-spelling-error">url.
    Here is my target:

<!-- -->
       &lt;!-- Target that creates a link to the builds report -->
      &lt;Target Name="SkapaLankTillByggRapporten">
        &lt;BuildStep TeamFoundationServerUrl="$(TeamFoundationServerUrl)"
                   BuildUri="$(BuildUri)"
                   Name="CreateLinkFileToBuildReport"
                   Message="Create link to build report"
                   Status="Succeeded" />
        &lt;Message Text="Create link to build report" />
       &lt;Copy SourceFiles="$(SolutionRoot)\Solution Items\Tools\BuildReportLink.txt" DestinationFiles="\\$(DropServerName)\Drops\$(AppName)\TestResults\BuildReportLink.url" />
      &lt;/Target>



-   Finally I made my build script call that target

As I said - maybe not a very pretty solution but it sure came through
for us and helped us report code coverage data in a nice way.

<span id="SPELLING_ERROR_34"
class="blsp-spelling-corrected">Oops - almost forgot... To
reconnect to the title of this post. This "technique" can of course be
applied to any report in <span id="SPELLING_ERROR_35"
class="blsp-spelling-error">TFS or other URL-<span
id="SPELLING_ERROR_36"
class="blsp-spelling-corrected">addressable <span
id="SPELLING_ERROR_37"
class="blsp-spelling-corrected">resources.
