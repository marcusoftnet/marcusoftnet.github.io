---
layout: post
title: Displaying XML in WebBrowser control
date: '2007-12-18T08:20:00.000+01:00'
author: Marcus Hammarberg
tags:
- VB.NET
- Visual Studio
modified_time: '2010-12-14T16:19:05.499+01:00'
blogger_id: tag:blogger.com,1999:blog-36533086.post-2986599029917462335
blogger_orig_url: http://www.marcusoft.net/2007/12/displaying-xml-in-webbrowser-control.html
---

This is one of those "how can this be hard stuff", and after checking the Net i couldn't find anything much about how to do it.<br /><br />The case is as follow; say that you have some XML that you want to display to the user. What better way than to use the nice format used by Internet Explorer itself. So you use the <span class="blsp-spelling-error" id="SPELLING_ERROR_0">WebBrowser</span> control in Visual Studio 2005 and simply pour the XML into the <span class="blsp-spelling-error" id="SPELLING_ERROR_1">DocumentText</span>-property... But hey - where are my tags? Where is the formatting?<br /><br />So how do you display XML in the <span class="blsp-spelling-error" id="SPELLING_ERROR_2">WebBrowser</span> then? Well the simplest way is to save the XML-file to disk and simply start it with Process.Start. This might also be quite enough for some solutions.<br /><br />But if you need to do this over and over you want to work with the XML-file in memory. In order to get the nice formatting you'll need to do some XML transformations also.<br /><br />So get the IE XML <span class="blsp-spelling-corrected" id="SPELLING_ERROR_3">style sheet</span> for displaying <span class="blsp-spelling-corrected" id="SPELLING_ERROR_4">XML</span> (from here for example: <a href="http://www.biglist.com/lists/xsl-list/archives/200003/msg00769.html">http://www.biglist.com/lists/xsl-list/archives/200003/msg00769.html</a>) and import it as a resource in your project. You could also hold it as a string variable but that is not as nice.<br /><br />The following method does the transformation for you:<br /><code><br />''' <summary><br />''' Transforms the XML-string with the sent-in <span class="blsp-spelling-error" id="SPELLING_ERROR_5">XSL</span>-string<br />''' </summary><br />''' <param name="xmlString">the <span class="blsp-spelling-error" id="SPELLING_ERROR_6">xml</span> to transform</param><br />''' <param name="xlsString">the <span class="blsp-spelling-error" id="SPELLING_ERROR_7">xsl</span> to use for the transformation</param><br />''' <returns>a <span class="blsp-spelling-error" id="SPELLING_ERROR_8">memorystream</span> with the result of the transformation</returns><br />''' <remarks><br />''' An example of a call to set the XML in a <span class="blsp-spelling-error" id="SPELLING_ERROR_9">webbrowser</span><br />''' <span class="blsp-spelling-error" id="SPELLING_ERROR_10">WebBrowser</span>1.<span class="blsp-spelling-error" id="SPELLING_ERROR_11">DocumentStream</span> = <span class="blsp-spelling-error" id="SPELLING_ERROR_12">TransformXML</span>(<span class="blsp-spelling-error" id="SPELLING_ERROR_13">xml</span>, My.Resources.PositionsDetaljer)<br />''' </remarks><br />Friend Shared Function <span class="blsp-spelling-error" id="SPELLING_ERROR_14">TransformXML</span>(<span class="blsp-spelling-error" id="SPELLING_ERROR_15">ByVal</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_16">xmlString</span> As String, <span class="blsp-spelling-error" id="SPELLING_ERROR_17">ByVal</span> <span class="blsp-spelling-error" id="SPELLING_ERROR_18">xlsString</span> As String) As <span class="blsp-spelling-error" id="SPELLING_ERROR_19">MemoryStream</span><br />Dim <span class="blsp-spelling-error" id="SPELLING_ERROR_20">memStream</span> As <span class="blsp-spelling-error" id="SPELLING_ERROR_21">MemoryStream</span> = Nothing<br />Try<br />' Create a <span class="blsp-spelling-error" id="SPELLING_ERROR_22">xml</span>-document from the sent-in <span class="blsp-spelling-error" id="SPELLING_ERROR_23">xml</span>-string<br />Dim <span class="blsp-spelling-error" id="SPELLING_ERROR_24">xmlDoc</span> As New <span class="blsp-spelling-error" id="SPELLING_ERROR_25">XmlDocument</span><br /><span class="blsp-spelling-error" id="SPELLING_ERROR_26">xmlDoc</span>.<span class="blsp-spelling-error" id="SPELLING_ERROR_27">LoadXml</span>(<span class="blsp-spelling-error" id="SPELLING_ERROR_28">xmlString</span>)<br /><br />' Load the <span class="blsp-spelling-error" id="SPELLING_ERROR_29">xls</span> into another document<br />Dim <span class="blsp-spelling-error" id="SPELLING_ERROR_30">xslDoc</span> As New <span class="blsp-spelling-error" id="SPELLING_ERROR_31">XmlDocument</span><br /><span class="blsp-spelling-error" id="SPELLING_ERROR_32">xslDoc</span>.<span class="blsp-spelling-error" id="SPELLING_ERROR_33">LoadXml</span>(<span class="blsp-spelling-error" id="SPELLING_ERROR_34">xlsString</span>)<br /><br />' Create a transformation<br />Dim trans As New <span class="blsp-spelling-error" id="SPELLING_ERROR_35">XslCompiledTransform</span><br />trans.Load(<span class="blsp-spelling-error" id="SPELLING_ERROR_36">xslDoc</span>)<br /><br />' Create a memory stream for output<br /><span class="blsp-spelling-error" id="SPELLING_ERROR_37">memStream</span> = New <span class="blsp-spelling-error" id="SPELLING_ERROR_38">MemoryStream</span>()<br /><br />' Do the transformation according to the <span class="blsp-spelling-error" id="SPELLING_ERROR_39">XSLT</span> and save the result in our memory stream<br />trans.Transform(<span class="blsp-spelling-error" id="SPELLING_ERROR_40">xmlDoc</span>, Nothing, <span class="blsp-spelling-error" id="SPELLING_ERROR_41">memStream</span>)<br /><span class="blsp-spelling-error" id="SPELLING_ERROR_42">memStream</span>.Position = 0<br />Catch ex As Exception<br />Throw ex<br />End Try<br /><br />Return <span class="blsp-spelling-error" id="SPELLING_ERROR_43">memStream</span><br />End Function<br /></code><br /><br />The final part is almost trivial:<br /><code><br /><span class="blsp-spelling-error" id="SPELLING_ERROR_44">WebBrowser</span>1.<span class="blsp-spelling-error" id="SPELLING_ERROR_45">DocumentStream</span> = <span class="blsp-spelling-error" id="SPELLING_ERROR_46">TransformXML</span>(m_message, My.Resources.IEXMLDefaultStyle)</code><br /><br />One last <span class="blsp-spelling-corrected" id="SPELLING_ERROR_47">gotcha</span> though - don't set any of the Document properties in the constructor of the form. Do it in the Load-event handler or later.